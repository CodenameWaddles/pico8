pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
--space game

function _init()
	ship=make_ship()
	planets={}
	make_planet(32,12,13,"earth")
end

function _update()
	control_ship(ship)
	move_ship(ship)
	move_bullets(ship)
end

function _draw()
	cls()
	draw_map()
	draw_ship(ship)
	draw_bullets(ship)
end
-->8
--ship stuff

accel=0.3
decel=0.2
bullet_speed=3

function make_ship()
	ship={}
	ship.x=8 ship.y=8
	ship.vx=0 ship.vy=0
	--ship.ax=0 ship.ay=0
	ship.health=5 ship.sprite=0
	ship.direction=0
	ship.bullets={}
	return ship
end

function make_bullet(s)
	if(#s.bullets<5) then
		bullet={}
		bullet.x=s.x bullet.y=s.y
		bullet.direction=s.direction
		bullet.sprite=17
		add(s.bullets,bullet)
	end
end

function control_ship(s)
	if(btn(‚¨ÖÔ∏è) and s.vx>-1.5) s.vx-=accel
	if(btn(‚û°Ô∏è) and s.vx<1.5) s.vx+=accel
	if(btn(‚¨ÜÔ∏è) and s.vy>-1.5) s.vy-=accel
	if(btn(‚¨áÔ∏è) and s.vy<1.5) s.vy+=accel
	poke(0x5f5c, 255)
	if(btnp(üÖæÔ∏è)) make_bullet(s)
end

function move_ship(s)
	s.x+=s.vx
	s.y+=s.vy
	if(s.vx==0 and s.vy<0) s.direction=0
	if(s.vx<0 and s.vy<0 and s.vx==s.vy) s.direction=1
	if(s.vx<0 and s.vy==0) s.direction=2
	if(s.vx<0 and s.vy>0 and s.vx==-s.vy) s.direction=3
	if(s.vx==0 and s.vy>0) s.direction=4
	if(s.vx>0 and s.vy>0 and s.vx==s.vy) s.direction=5
	if(s.vx>0 and s.vy==0) s.direction=6
	if(s.vx>0 and s.vy<0 and s.vx==-s.vy) s.direction=7
end

function move_bullet(b)
	if(b.direction==0) b.y-=bullet_speed
	if(b.direction==1) b.x-=bullet_speed b.y-=bullet_speed
	if(b.direction==2) b.x-=bullet_speed
	if(b.direction==3) b.x-=bullet_speed b.y+=bullet_speed
	if(b.direction==4) b.y+=bullet_speed
	if(b.direction==5) b.x+=bullet_speed b.y+=bullet_speed
	if(b.direction==6) b.x+=bullet_speed
	if(b.direction==7) b.x+=bullet_speed b.y-=bullet_speed
end

function move_bullets(s)
	foreach(s.bullets,move_bullet)
end

function draw_bullet(b)
	spr(b.sprite,b.x,b.y)
end

function draw_bullets(s)
	foreach(s.bullets,draw_bullet)
end

function draw_ship(s)
	spr(s.sprite+s.direction,s.x,s.y)
end
-->8
--{} [] #
-->8
--map and planets

function make_planet(sprite,x,y,name)
	planet={}
	planet.sprite=sprite
	planet.x=x planet.y=y
	planet.name=name
	add(planets,planet)
end

function draw_map()
	map()
	for p in all(planets) do spr(p.sprite,p.x,p.y) end
end
__gfx__
00008000880000000000000000090000090090090000900000000000000000880000000000000000000000000000000000000000000000000000000000000000
00088800888800000000099900990090099090990900990099900000000088880000000000000000000000000000000000000000000000000000000000000000
00088800088889900008889000988900098898890098890009888000099888800000000000000000000000000000000000000000000000000000000000000000
00888880088888990888880000889800008888800089880000888880998888800000000000000000000000000000000000000000000000000000000000000000
00888880008898008888899908888899008888809988888099988888008988000000000000000000000000000000000000000000000000000000000000000000
09889889009889000888880008888990000888000998888000888880009889000000000000000000000000000000000000000000000000000000000000000000
09909099009900900008889088880000000888000000888809888000090099000000000000000000000000000000000000000000000000000000000000000000
09009009000900000000099988000000000080000000008899900000000090000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000990000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00c77c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0bbcccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cbcccbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cbccbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccbccbcb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccbbcbcc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0cbcccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00c77c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000013000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000130000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000001300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000130000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000130000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000120000000000000000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
