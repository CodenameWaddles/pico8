pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
-- sprite stacking example
-- by @johanpeitz

function _draw()
	cls(5)

	-- draw roundabout
	circfill(64,70,32,13)
	circfill(64,68,32,6)

	-- draw busses 
	local angle=-t()/8
	draw_bus(
	56+40*cos(angle),
	64+40*sin(angle),
	-angle-0.25)
end

function draw_bus(x,y,a)
 -- draw stack
 for i=0,12 do
  local sx = 16 * (i%8)
  local sy = 16 * flr(i/8)
  rspr(sx,sy,
       x, y-i*1,
       a, 2)
 end
 
end
-->8
-- sprite rotation by @fsouchu

-- rotate a sprite
-- col 15 is transparent
-- sx,sy - sprite sheet coords
-- x,y - screen coords
-- a - angle
-- w - width in tiles
function rspr(sx,sy,x,y,a,w)
	local ca,sa=cos(a),sin(a)
	local srcx,srcy
	local ddx0,ddy0=ca,sa
	local mask=shl(0xfff8,(w-1))
	w*=4
	ca*=w-0.5
	sa*=w-0.5
	local dx0,dy0=sa-ca+w,-ca-sa+w
	w=2*w-1
	for ix=0,w do
		srcx,srcy=dx0,dy0
		for iy=0,w do
			if band(bor(srcx,srcy),mask)==0 then
				local c=sget(sx+srcx,sy+srcy)
    -- set transparent color here
				if (c!=11) pset(x+ix,y+iy,c)
			end
			srcx-=ddy0
			srcy+=ddx0
		end
		dx0+=ddx0
		dy0+=ddy0
	end
end

__gfx__
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb5bbbbbbbbbbbbbbb5bbbbbbbbbbbbbbbbbbbbbbbbbbbb
22b00b22222b00b6888008888777007788888887777777778888877777777777bb88777777777773bbb8ddd777777333bbb7ddd777733333bbb7777773333333
2222222222266666882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
1222222222266661882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
1222222222266661882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
1222222222266661882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
1222222222266661882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
2222222222266666882222222266666d8bbbbbbbbbbbbbb58888bbbbbbbbbbbdbb88bbbbbbbbbbb5bbbddbbbbbbbbbbdbbbdbbbbbbbbbbb5bbbdbbbbbbbbbbb3
22b00b22222b00b6888008888777007788888887777777778888877777777777bb88777777777773bbb8ddd777777333bbb7ddd777733333bbb7777773333333
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb5bbbbbbbbbbbbbbb5bbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbf8488488fbbbbbbbff84884ffbbbbbbbbff884ffbbbbbbbbbbfffffbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbf8488848fbbbbbbbff88488ffbbbbbbbbff488ffbbbbbbbbbbfffffbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbb7777333333333bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555858555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555558888855555555555555555555555555555555555555
55555555555555555555555555555555555588855555555555555555555555555555555555555555555588888885555555555555555555555555555555555555
55555555555555555555555555555555555888885555555555555555555555555555555555555555555588888888555555555555555555555555555555555555
55555555555555555555555555555555558888888555555555555555555555555555555555555555555888888888855555555555555555555555555555555555
55555555555555555555555555555555588888888555555555555555555555555555555555555555555888888888885555555555555555555555555555555555
555555555555555555555555555555558888888885555555555555555555555555555555555555555558d8888888888555555555555555555555555555555555
555555555555555555555555555555588888888885555555555555555555555555555555555555555558dd888888888855555555555555555555555555555555
5555555555555555555555555555558888888888d55555555555555555555555555555555555555555578dd88888888885555555555555555555555555555555
5555555555555555555555555555588888888888d555555555555555555555555555555555555555555d78dd8888888888555555555555555555555555555555
55555555555555555555555555558888888888d88555555555555555555555555555555555555555555d878dd888888888555555555555555555555555555555
5555555555555555555555555558888888888dd8755555555555555555566666666666555555555555588d78dd88888888855555555555555555555555555555
555555555555555555555555555888888888dd87855555555555555666666666666666666655555555578d878dd8888888855555555555555555555555555555
55555555555555555555555555588888888dd87d85555555555566666666666666666666666665555552888d78dd88888d855555555555555555555555555555
5555555555555555555555555558888888dd878d85555555556666666666666666666666666666655555508dd78d8888dd855555555555555555555555555555
555555555555555555555555555d88888dd87d88855555556666666666666666666666666666666665555088d8788d8dd8755555555555555555555555555555
555555555555555555555555555dd888dd878d8025555556666666666666666666666666666666666655555888d78d8d87555555555555555555555555555555
5555555555555555555555555558dd8dd87d880055555666666666666666666666666666666666666666555288d8788875555555555555555555555555555555
55555555555555555555555555571d8d87dd88055555666666666666666666666666666666666666666665552888d777d8555555555555555555555555555555
5555555555555555555555555558788878d885555556666666666666666666666666666666666666666666555288d8ddd8855555555555555555555555555555
55555555555555555555555555588787d8882555556666666666666666666666666666666666666666666665555088dd88255555555555555555555555555555
55555555555555555555555555566d78d88255555666666666666666666666666666666666666666666666665550088882555555555555555555555555555555
55555555555555555555555555566dd8882555556666666666666666666666666666666666666666666666666555088815555555555555555555555555555555
555555555555555555555555555266d8055555566666666666666666666666666666666666666666666666666655522255555555555555555555555555555555
55555555555555555555555555551688055555666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555
55555555555555555555555555555275555555666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555
55555555555555555555555555555525555556666666666666666666666666666666666666666666666666666666555555555555555555555555555555555555
55555555555555555555555555555555555566666666666666666666666666666666666666666666666666666666655555555555555555555555555555555555
55555555555555555555555555555555555566666666666666666666666666666666666666666666666666666666655555555555555555555555555555555555
55555555555555555555555555555555555666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555
55555555555555555555555555555555555666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555
55555555555555555555555555555555556666666666666666666666666666666666666666666666666666666666666555555555555555555555555555555555
55555555555555555555555555555555556666666666666666666666666666666666666666666666666666666666666555555555555555555555555555555555
55555555555555555555555555555555556666666666666666666666666666666666666666666666666666666666666555555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555
55555555555555555555555555555555d666666666666666666666666666666666666666666666666666666666666666d5555555555555555555555555555555
55555555555555555555555555555555d666666666666666666666666666666666666666666666666666666666666666d5555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
555555555555555555555555555555555d6666666666666666666666666666666666666666666666666666666666666d55555555555555555555555555555555
555555555555555555555555555555555d6666666666666666666666666666666666666666666666666666666666666d55555555555555555555555555555555
55555555555555555555555555555555556666666666666666666666666666666666666666666666666666666666666555555555555555555555555555555555
5555555555555555555555555555555555d66666666666666666666666666666666666666666666666666666666666d555555555555555555555555555555555
5555555555555555555555555555555555d66666666666666666666666666666666666666666666666666666666666d888555555555555555555555555555555
55555555555555555555555555555555555d666666666666666666666666666666666666666666666666666666666d8888855555555555555555555555555555
55555555555555555555555555555558585d66666666666666666666666666666666666666666666666666666666688888885555555555555555555555555555
555555555555555555555555555555888885d6666666666666666666666666666666666666666666666666666666888888885555555555555555555555555555
555555555555555555555555555558888888dd666666666666666666666666666666666666666666666666666668888888885555555555555555555555555555
5555555555555555555555555555588888888d666666666666666666666666666666666666666666666666666688888888885555555555555555555555555555
55555555555555555555555555558888888888d666666666666666666666666666666666666666666666666668888888888d5555555555555555555555555555
555555555555555555555555555588888888888d66666666666666666666666666666666666666666666666688888888888d5555555555555555555555555555
55555555555555555555555555558d8888888888d66666666666666666666666666666666666666666666668888888888d885555555555555555555555555555
555555555555555555555555555588d8888888888d666666666666666666666666666666666666666666668888888888dd875555555555555555555555555555
5555555555555555555555555555718d8888888888d6666666666666666666666666666666666666666666888888888dd8765555555555555555555555555555
5555555555555555555555555555571dd8888888888d66666666666666666666666666666666666666666d88888888dd87885555555555555555555555555555
55555555555555555555555555555578dd888888888dd666666666666666666666666666666666666666dd8888888dd878885555555555555555555555555555
555555555555555555555555555558678dd888888888ddd66666666666666666666666666666666666ddd5d88888dd87d8885555555555555555555555555555
5555555555555555555555555555886878dd888888885ddd666666666666666666666666666666666ddd55dd888dd87dd8055555555555555555555555555555
55555555555555555555555555552828d78dd88888d8555ddd66666666666666666666666666666ddd55558dd8d8878d88055555555555555555555555555555
55555555555555555555555555555288d878d8888dd85555dddd6666666666666666666666666dddd5555578d8817d8885555555555555555555555555555555
5555555555555555555555555555555088d788d8dd87555555ddddd6666666666666666666ddddd5555555d788178d8825555555555555555555555555555555
5555555555555555555555555555555088dd78d8d17d55555555ddddddd66666666666ddddddd555555555dd7878888255555555555555555555555555555555
55555555555555555555555555555555588d878887dd55555555555ddddddddddddddddddd5555555555558d8722882555555555555555555555555555555555
55555555555555555555555555555555528888777dd8555555555555555ddddddddddd5555555555555555882620055555555555555555555555555555555555
55555555555555555555555555555555552888888667555555555555555555555555555555555555555555288628055555555555555555555555555555555555
55555555555555555555555555555555555288886662555555555555555555555555555555555555555555518885555555555555555555555555555555555555
55555555555555555555555555555555555550886625555555555555555555555555555555555555555555552825555555555555555555555555555555555555
55555555555555555555555555555555555550876155555555555555555555555555555555555555555555555255555555555555555555555555555555555555
55555555555555555555555555555555555555522555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

